<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Igreja Batista Nova Vida - Minist√©rio de Dan√ßa DNA</title>
    <link rel="stylesheet" href="../css/style.css"> 
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        /* --- ESTILOS ORIGINAIS DO CHAT (Mantidos) --- */
        .chat-toggle-btn { position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px; background-color: #007bff; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 28px; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 9999; transition: transform 0.3s ease; }
        .chat-toggle-btn:hover { transform: scale(1.1); }
        .chat-window { position: fixed; bottom: 90px; right: 20px; width: 350px; max-width: 90%; background: white; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.2); display: none; flex-direction: column; overflow: hidden; z-index: 9999; font-family: 'Open Sans', sans-serif; border: 1px solid #eee; }
        .chat-header { background-color: #007bff; color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .chat-header h4 { margin: 0; font-size: 16px; font-family: 'Montserrat', sans-serif; }
        .close-chat { cursor: pointer; font-size: 20px; }
        .chat-body { height: 300px; overflow-y: auto; padding: 15px; background-color: #f9f9f9; display: flex; flex-direction: column; gap: 10px; }
        .message { max-width: 80%; padding: 10px 15px; border-radius: 15px; font-size: 14px; line-height: 1.4; animation: fadeIn 0.3s ease; }
        .bot-msg { background-color: #e9ecef; color: #333; align-self: flex-start; border-bottom-left-radius: 2px; }
        .user-msg { background-color: #007bff; color: white; align-self: flex-end; border-bottom-right-radius: 2px; }
        .chat-input-area { padding: 10px; border-top: 1px solid #ddd; display: flex; gap: 5px; background: white; }
        .chat-input-area input { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 20px; outline: none; }
        .chat-input-area button { background: #007bff; color: white; border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .whatsapp-group-btn { display: inline-block; background-color: #25d366; color: white; text-decoration: none; padding: 10px 20px; border-radius: 20px; font-weight: bold; margin-top: 5px; text-align: center; border: none; cursor: pointer; }
        .whatsapp-group-btn:hover { background-color: #1ebc57; color: white; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- NOVOS ESTILOS PARA A GALERIA DIN√ÇMICA E LIGHTBOX --- */
        
        /* Grade da Galeria */
        .dynamic-gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 20px;
            margin-bottom: 40px;
        }

        .gallery-item {
            position: relative;
            aspect-ratio: 1;
            overflow: hidden;
            border-radius: 8px;
            cursor: pointer;
            background: #f0f0f0;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .gallery-item:hover { transform: scale(1.03); z-index: 2; }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        /* √çcone de Play para v√≠deos */
        .video-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.3);
            display: flex; align-items: center; justify-content: center;
        }
        .play-icon { font-size: 30px; color: white; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.8)); }

        .status-msg {
            grid-column: 1 / -1;
            text-align: center;
            padding: 30px;
            color: #666;
            font-style: italic;
        }

        /* LIGHTBOX (Janela Modal) */
        .lightbox {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.95); z-index: 10000;
            display: none; justify-content: center; align-items: center;
            backdrop-filter: blur(5px);
            opacity: 0; transition: opacity 0.3s ease;
        }
        .lightbox.active { display: flex; opacity: 1; }

        .lightbox-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
            display: flex; justify-content: center; align-items: center;
        }

        .lightbox-img {
            max-width: 100%;
            max-height: 85vh;
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        .lightbox-video {
            width: 80vw;
            height: 80vh;
            max-width: 1000px;
            border: none;
            background: black;
        }

        .close-lightbox {
            position: absolute; top: 20px; right: 20px;
            color: white; font-size: 35px; cursor: pointer;
            background: rgba(255,255,255,0.1); width: 50px; height: 50px;
            border-radius: 50%; border: none; display: flex; align-items: center; justify-content: center;
            transition: 0.2s;
        }
        .close-lightbox:hover { background: rgba(255,255,255,0.3); }

    </style>
</head>
<body>

    <header class="main-header">
        <div class="container">
            <a href="../index.html" class="logo">IGREJA BATISTA NOVA VIDA</a>
            <nav class="main-nav">
                <ul class="nav-list">
                    <li><a href="../index.html">In√≠cio</a></li>
                    <li><a href="../about.html">Sobre N√≥s</a></li>
                    <li><a href="../sermons.html">Serm√µes</a></li>
                    <li><a href="../ministries.html">Minist√©rios</a></li>
                    <li><a href="../pascoa.html">P√°scoa</a></li>
                    <li><a href="../events.html">Eventos</a></li>
                    <li><a href="../give.html">D√™</a></li>
                    <li><a href="../contact.html">Contato</a></li>
                    <li><a href="#" class="btn btn-primary" id="headerSignUpBtn">Cadastre-se</a></li>
                </ul>
                <div class="hamburger-menu">
                    <i class="fas fa-bars"></i>
                </div>
            </nav>
        </div>
    </header>

    <main>
        <section class="section hero-page-header ministry-dna-bg">
            <div class="container text-center">
                <h1>Minist√©rio de Dan√ßa DNA</h1>
            </div>
        </section>

        <section class="section ministry-detail-content">
            <div class="container text-left">
                <p>O minist√©rio de dan√ßa da IBNV vai muito al√©m de coreografias bem elaboradas ou apresenta√ß√µes durante os cultos. Atrav√©s de cada movimento, expressamos nossa adora√ß√£o profunda e sincera a Deus.</p>
                <p><br>Buscamos levar uma dan√ßa que gera cura, liberta√ß√£o e transforma√ß√£o. Cada movimento carrega uma mensagem, cada gesto revela uma ora√ß√£o silenciosa, e cada coreografia rompe cadeias espirituais. Quando dan√ßamos somos guiadas pelo Esp√≠rito, nos tornamos pontes entre o c√©u e a terra, para que vidas sejam impactadas sem que uma √∫nica palavra seja dita.</p>
                <img src="../img/ministries/capadanca.jpg" alt="Grupo de crian√ßas em celebra√ß√£o de data comemorativa" class="ministry-detail-img">
                <p>No minist√©rio de dan√ßa DNA, transformamos sentimentos em movimentos. A dor, a alegria, a gratid√£o, o clamor, tudo se traduz em express√£o corporal que glorifica a Deus. Entregamos tudo a Ele que nos chama a viver esse prop√≥sito.</p>
                <p><br>Mais do que uma arte, a dan√ßa crist√£ √© uma miss√£o. Um chamado para ministrar atrav√©s do corpo aquilo que o cora√ß√£o carrega. E quando dan√ßamos com prop√≥sito, guiados pelo amor de Cristo, milagres acontecem: feridas s√£o curadas, pris√µes s√£o quebradas, e vidas s√£o restauradas.</p>
                
                <h3 style="margin-top: 3rem;">Nossa Galeria de Fotos</h3>
                <p>Dan√ßando com o cora√ß√£o para o Senhor. (Fotos atualizadas em tempo real)</p>
                
                <div class="dynamic-gallery-grid" id="ministryGallery">
                    <div class="status-msg">
                        <i class="fas fa-spinner fa-spin"></i> Carregando galeria...
                    </div>
                </div>
                <h3 style="margin-top: 3rem;">Nossos Ensaios Semanais</h3>
                <ul class="event-details-list">
                    <li><i class="fas fa-calendar-alt"></i>DNA Teens - Segunda e sexta √†s 19:00hs</li>
                    <li><i class="fas fa-calendar-alt"></i> DNA Kids - Quarta-feira √†s 19:00hs</li>
                    <li><i class="fas fa-calendar-alt"></i> DNA Young - Quarta-feira √†s 19:30hs S√°bado √†s 08:00hs</li>
                    <li><i class="fas fa-star"></i>Pr√≥ximo Evento Especial: <a href="../events/apresentacao-dna.html">Saiba Mais</a></li>
                </ul>

                <h3 style="margin-top: 3rem;">Conhe√ßa Nossos L√≠deres:</h3>
                <div class="ministry-participants-grid">
                    <div class="participant-card">
                        <img src="../img/perfil/debora.jpg" alt="Foto de debora">
                        <h4>D√©bora Pacheco Barbosa Ramos</h4>
                        <p>L√≠der S√™nior</p>
                        <ul class="social-links">
                            <li><a aria-label="Facebook" href="#"><i class="fab fa-facebook-f"></i></a></li>
                            <li><a aria-label="Instagram" href="https://www.instagram.com/deborapbr/?utm_source=ig_web_button_share_sheet"><i class="fab fa-instagram"></i></a></li>
                            <li><a aria-label="Email" href="#"><i class="fas fa-envelope"></i></a></li>
                        </ul>
                    </div>
                    <div class="participant-card">
                        <img src="../img/perfil/sollyane.jpg" alt="Foto de Sollyane">
                        <h4>Sollyane Queiroz</h4>
                        <p>Col√≠der</p>
                    </div>
                    </div>
                
                <a href="../ministries.html" class="btn btn-outline" style="margin-top: 3rem;">Voltar para Minist√©rios</a>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-links">
                <ul>
                    <li><a href="../index.html">In√≠cio</a></li>
                    <li><a href="../about.html">Sobre N√≥s</a></li>
                    <li><a href="../sermons.html">Serm√µes</a></li>
                    <li><a href="../ministries.html">Minist√©rios</a></li>
                </ul>
                <ul>
                    <li><a href="../pascoa.html">P√°scoa</a></li>
                    <li><a href="../events.html">Eventos</a></li>
                    <li><a href="../give.html">D√™</a></li>
                    <li><a href="../contact.html">Contato</a></li>
                    <li><a href="../privacy-policy.html">Privacidade</a></li>
                </ul>
            </div>
            <div class="footer-info">
                <p>¬© 2024 Igreja Batista Nova Vida. Todos os direitos reservados.</p>
                <p>Feito com ‚ù§Ô∏è pela comunidade.</p>
            </div>
        </div>
    </footer>

    <div id="lightbox" class="lightbox" onclick="closeLightbox(event)">
        <button class="close-lightbox" onclick="closeLightbox(null, true)">√ó</button>
        <div class="lightbox-content" id="lightboxContent"></div>
    </div>

    <div class="chat-toggle-btn" id="openMinistryChat">
        <i class="fas fa-robot"></i>
    </div>

    <div class="chat-window" id="ministryChatWindow">
        <div class="chat-header">
            <h4><i class="fas fa-running"></i> Cadastro Dan√ßa DNA</h4>
            <span class="close-chat" id="closeMinistryChat">√ó</span>
        </div>
        <div class="chat-body" id="ministryChatBody"></div>
        <div class="chat-input-area" id="ministryInputArea">
            <input type="text" id="ministryChatInput" placeholder="Digite sua resposta...">
            <button id="ministrySendBtn"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <script src="../js/script.js"></script>

    <script>
        // ============================================
        // 1. CONFIGURA√á√ÉO DA GALERIA GOOGLE DRIVE
        // ============================================
        
        // ‚ö†Ô∏è COLE A URL DO SEU GOOGLE APPS SCRIPT AQUI:
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx5EH-Up5_QT5hh2PeesKJMEodzTNDNyiWgvZfyuxOXBoR_udYnr_RhoBNNDI25fCp2/exec'; 
        
        // ‚ö†Ô∏è COLE O ID DA PASTA "DAN√áA" AQUI:
        const FOLDER_ID = '1Qxc3BmDLo4zN_URuD3tQT_j-irX6l-66'; 

        document.addEventListener('DOMContentLoaded', () => {
            loadGallery();
        });

        async function loadGallery() {
            const grid = document.getElementById('ministryGallery');
            
            try {
                // Chama o script para listar arquivos
                const response = await fetch(`${SCRIPT_URL}?action=list&folderId=${FOLDER_ID}`);
                const files = await response.json();

                grid.innerHTML = ''; // Limpa loading

                if (!files || files.length === 0) {
                    grid.innerHTML = '<div class="status-msg">Nenhuma foto encontrada nesta pasta.</div>';
                    return;
                }

                // Limita a exibir apenas as 20 fotos mais recentes (opcional)
                // files = files.slice(0, 20);

                files.forEach(file => {
                    // Link otimizado para mobile (miniatura)
                    const thumbUrl = `https://lh3.googleusercontent.com/d/${file.id}=s400`;

                    const item = document.createElement('div');
                    item.className = 'gallery-item';
                    item.onclick = () => openLightbox(file.type, file.id);

                    if (file.type.includes('image')) {
                        item.innerHTML = `<img src="${thumbUrl}" loading="lazy" alt="Foto Minist√©rio">`;
                    } else if (file.type.includes('video')) {
                        item.innerHTML = `
                            <img src="${thumbUrl}" loading="lazy" alt="V√≠deo Minist√©rio">
                            <div class="video-overlay"><i class="fas fa-play play-icon"></i></div>
                        `;
                    }
                    grid.appendChild(item);
                });

            } catch (error) {
                console.error(error);
                grid.innerHTML = '<div class="status-msg">Erro ao carregar a galeria. Verifique a conex√£o.</div>';
            }
        }

        // --- FUN√á√ïES DO LIGHTBOX ---
        function openLightbox(type, fileId) {
            const lightbox = document.getElementById('lightbox');
            const content = document.getElementById('lightboxContent');
            content.innerHTML = '<div style="color:white"><i class="fas fa-spinner fa-spin"></i></div>';
            
            lightbox.classList.add('active');

            setTimeout(() => {
                if (type.includes('image')) {
                    // Imagem Grande (=s2000)
                    const fullUrl = `https://lh3.googleusercontent.com/d/${fileId}=s2000`;
                    content.innerHTML = `<img src="${fullUrl}" class="lightbox-img">`;
                } else {
                    // V√≠deo Player
                    const videoUrl = `https://drive.google.com/file/d/${fileId}/preview`;
                    content.innerHTML = `<iframe src="${videoUrl}" class="lightbox-video" allow="autoplay; fullscreen"></iframe>`;
                }
            }, 100);
        }

        function closeLightbox(event, force) {
            if (force || event.target.id === 'lightbox') {
                document.getElementById('lightbox').classList.remove('active');
                setTimeout(() => { document.getElementById('lightboxContent').innerHTML = ''; }, 300);
            }
        }

        // ============================================
        // 2. SCRIPT DO CHAT (MANTIDO DO ORIGINAL)
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            const openBtn = document.getElementById('openMinistryChat');
            const headerSignUpBtn = document.getElementById('headerSignUpBtn');
            const closeBtn = document.getElementById('closeMinistryChat');
            const chatWindow = document.getElementById('ministryChatWindow');
            const chatBody = document.getElementById('ministryChatBody');
            const chatInput = document.getElementById('ministryChatInput');
            const sendBtn = document.getElementById('ministrySendBtn');
            const inputArea = document.getElementById('ministryInputArea');

            // ‚ö†Ô∏è ATEN√á√ÉO: COLOQUE SEU N√öMERO AQUI
            const adminPhoneNumber = "5527996992890"; 

            let step = 0;
            let userName = "";
            let userPhone = "";
            let experience = "";
            let preference = "";

            function openChat() {
                chatWindow.style.display = 'flex';
                if(step === 0) {
                    botSay("Ol√°! A paz do Senhor! üíÉ");
                    setTimeout(() => botSay("Que b√™n√ß√£o ver voc√™ interessada(o) em adorar a Deus com a dan√ßa."), 1000);
                    setTimeout(() => botSay("Para come√ßarmos, qual √© o seu **Nome Completo**?"), 2500);
                    step = 1;
                }
            }

            if(openBtn) openBtn.addEventListener('click', openChat);
            if(headerSignUpBtn) headerSignUpBtn.addEventListener('click', (e) => { e.preventDefault(); openChat(); });
            if(closeBtn) closeBtn.addEventListener('click', () => { chatWindow.style.display = 'none'; });

            if(sendBtn) sendBtn.addEventListener('click', processInput);
            if(chatInput) chatInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') processInput(); });

            function processInput() {
                const text = chatInput.value.trim();
                if(!text) return;
                userSay(text);
                chatInput.value = '';

                if(step === 1) {
                    userName = text;
                    setTimeout(() => botSay(`Prazer, ${userName}! ‚ú®`), 600);
                    setTimeout(() => botSay("Para contato, qual √© o seu n√∫mero de **WhatsApp (com DDD)**?"), 1500);
                    step = 2;
                } 
                else if(step === 2) {
                    userPhone = text;
                    setTimeout(() => botSay("Voc√™ j√° tem alguma experi√™ncia com dan√ßa (ballet, jazz, urbano, etc)?"), 1000);
                    step = 3;
                }
                else if(step === 3) {
                    experience = text;
                    setTimeout(() => botSay("Legal! E voc√™ gostaria de participar mais das ministra√ß√µes nos **Cultos** ou apenas dos **Projetos Especiais** (como Natal e P√°scoa)?"), 1000);
                    step = 4;
                }
                else if(step === 4) {
                    preference = text;
                    setTimeout(() => botSay("Maravilha! Deus aben√ßoe seu talento."), 800);
                    setTimeout(() => {
                        botSay("Seu cadastro est√° pronto! Clique abaixo para enviar essas informa√ß√µes para a nossa lideran√ßa via WhatsApp:");
                        addLinkButton();
                        inputArea.style.display = 'none';
                    }, 2000);
                    step = 5;
                }
            }

            function botSay(text) {
                const msgDiv = document.createElement('div');
                msgDiv.className = 'message bot-msg';
                msgDiv.innerHTML = text;
                chatBody.appendChild(msgDiv);
                chatBody.scrollTop = chatBody.scrollHeight;
            }

            function userSay(text) {
                const msgDiv = document.createElement('div');
                msgDiv.className = 'message user-msg';
                msgDiv.textContent = text;
                chatBody.appendChild(msgDiv);
                chatBody.scrollTop = chatBody.scrollHeight;
            }

            function addLinkButton() {
                const finalMessage = `Ol√°! Gostaria de participar do Minist√©rio de Dan√ßa DNA.%0A%0A*Nome:* ${userName}%0A*WhatsApp:* ${userPhone}%0A*Experi√™ncia:* ${experience}%0A*Prefer√™ncia:* ${preference}`;
                const whatsappUrl = `https://wa.me/${adminPhoneNumber}?text=${finalMessage}`;
                const btn = document.createElement('a');
                btn.href = whatsappUrl;
                btn.target = "_blank";
                btn.className = 'whatsapp-group-btn';
                btn.innerHTML = '<i class="fab fa-whatsapp"></i> Enviar Cadastro';
                const container = document.createElement('div');
                container.style.textAlign = 'center';
                container.style.width = '100%';
                container.appendChild(btn);
                chatBody.appendChild(container);
                chatBody.scrollTop = chatBody.scrollHeight;
            }
        });
    </script>
</body>
</html>
